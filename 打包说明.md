# æ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å°† SenseVoice é¡¹ç›®æ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ–¹ä¾¿éæŠ€æœ¯ç”¨æˆ·ä½¿ç”¨ã€‚

## ğŸ“¦ æ‰“åŒ…å·¥å…·

æˆ‘ä»¬ä½¿ç”¨ **PyInstaller** æ¥æ‰“åŒ… Python åº”ç”¨ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³• 1: ä½¿ç”¨è‡ªåŠ¨æ‰“åŒ…è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# 1. å®‰è£… PyInstaller
pip install pyinstaller

# 2. è¿è¡Œæ‰“åŒ…è„šæœ¬
python build_executable.py
```

### æ–¹æ³• 2: ä½¿ç”¨ PyInstaller ç›´æ¥æ‰“åŒ…

```bash
# å®‰è£… PyInstaller
pip install pyinstaller

# æ‰“åŒ… Web UIï¼ˆæ¨èï¼ŒåŒ…å«å›¾å½¢ç•Œé¢ï¼‰
pyinstaller --name=SenseVoice --onefile --windowed --add-data="readme.md;." webui.py

# æˆ–ä½¿ç”¨é…ç½®æ–‡ä»¶
pyinstaller build.spec
```

## ğŸ“‹ æ‰“åŒ…é€‰é¡¹è¯´æ˜

### åŸºæœ¬å‚æ•°

- `--name=SenseVoice`: å¯æ‰§è¡Œæ–‡ä»¶åç§°
- `--onefile`: æ‰“åŒ…æˆå•ä¸ªæ–‡ä»¶ï¼ˆæ¨èï¼‰
- `--windowed` / `-w`: ä¸æ˜¾ç¤ºæ§åˆ¶å°çª—å£ï¼ˆGUI æ¨¡å¼ï¼‰
- `--console` / `-c`: æ˜¾ç¤ºæ§åˆ¶å°çª—å£ï¼ˆè°ƒè¯•ç”¨ï¼‰

### æ·»åŠ æ•°æ®æ–‡ä»¶

- `--add-data="readme.md;."`: æ·»åŠ  readme.md æ–‡ä»¶ï¼ˆWindows ç”¨ `;` åˆ†éš”ï¼‰
- `--add-data="readme.md:."`: æ·»åŠ  readme.md æ–‡ä»¶ï¼ˆmacOS/Linux ç”¨ `:` åˆ†éš”ï¼‰

### éšè—å¯¼å…¥

- `--hidden-import=gradio`: ç¡®ä¿ gradio è¢«åŒ…å«
- `--hidden-import=funasr`: ç¡®ä¿ funasr è¢«åŒ…å«
- `--collect-all=gradio`: æ”¶é›† gradio çš„æ‰€æœ‰å­æ¨¡å—

## ğŸ¯ ä¸åŒå¹³å°çš„æ‰“åŒ…

### macOS

```bash
pyinstaller --name=SenseVoice \
    --onefile \
    --windowed \
    --osx-bundle-identifier=com.sensevoice.app \
    --add-data="readme.md:." \
    webui.py
```

ç”Ÿæˆçš„æ–‡ä»¶ï¼š`dist/SenseVoice.app`

### Windows

```bash
pyinstaller --name=SenseVoice ^
    --onefile ^
    --windowed ^
    --add-data="readme.md;." ^
    webui.py
```

ç”Ÿæˆçš„æ–‡ä»¶ï¼š`dist/SenseVoice.exe`

### Linux

```bash
pyinstaller --name=SenseVoice \
    --onefile \
    --windowed \
    --add-data="readme.md:." \
    webui.py
```

ç”Ÿæˆçš„æ–‡ä»¶ï¼š`dist/SenseVoice`

## ğŸ“ æ‰“åŒ…åçš„æ–‡ä»¶ç»“æ„

```
dist/
â”œâ”€â”€ SenseVoice.exe (Windows) æˆ– SenseVoice.app (macOS)
â””â”€â”€ ...

build/
â””â”€â”€ ... (ä¸´æ—¶æ–‡ä»¶ï¼Œå¯ä»¥åˆ é™¤)
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ–‡ä»¶å¤§å°

æ‰“åŒ…åçš„æ–‡ä»¶ä¼šæ¯”è¾ƒå¤§ï¼ˆå¯èƒ½ 200MB+ï¼‰ï¼Œå› ä¸ºåŒ…å«äº†æ‰€æœ‰ä¾èµ–ï¼š
- PyTorch (~150MB)
- Gradio (~20MB)
- å…¶ä»–ä¾èµ– (~30MB)

### 2. é¦–æ¬¡è¿è¡Œ

- é¦–æ¬¡è¿è¡Œéœ€è¦ä¸‹è½½æ¨¡å‹ï¼ˆéœ€è¦ç½‘ç»œè¿æ¥ï¼‰
- æ¨¡å‹ä¼šä¸‹è½½åˆ° `./models/` ç›®å½•
- ä¸‹è½½å®Œæˆåå¯ä»¥ç¦»çº¿ä½¿ç”¨

### 3. æ¨¡å‹æ–‡ä»¶

æ¨¡å‹æ–‡ä»¶ï¼ˆ~900MBï¼‰ä¸ä¼šæ‰“åŒ…åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œéœ€è¦ï¼š
- é¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨ä¸‹è½½
- æˆ–æ‰‹åŠ¨ä¸‹è½½åæ”¾åˆ° `models/` ç›®å½•

### 4. åˆ†å‘å»ºè®®

åˆ†å‘æ—¶å»ºè®®åŒ…å«ï¼š
```
SenseVoice/
â”œâ”€â”€ SenseVoice.exe (æˆ– .app)
â”œâ”€â”€ models/ (å¯é€‰ï¼Œå¦‚æœå·²ä¸‹è½½æ¨¡å‹)
â””â”€â”€ README.txt (ä½¿ç”¨è¯´æ˜)
```

## ğŸ”§ é«˜çº§é…ç½®

### æ·»åŠ å›¾æ ‡

1. å‡†å¤‡å›¾æ ‡æ–‡ä»¶ï¼š
   - Windows: `.ico` æ–‡ä»¶
   - macOS: `.icns` æ–‡ä»¶

2. æ‰“åŒ…æ—¶æ·»åŠ ï¼š
   ```bash
   pyinstaller --icon=icon.ico webui.py
   ```

### å‡å°æ–‡ä»¶å¤§å°

1. ä½¿ç”¨ `--exclude-module` æ’é™¤ä¸éœ€è¦çš„æ¨¡å—
2. ä½¿ç”¨ UPX å‹ç¼©ï¼ˆå¦‚æœå¯ç”¨ï¼‰
3. è€ƒè™‘ä½¿ç”¨ `--onedir` è€Œä¸æ˜¯ `--onefile`ï¼ˆå¤šä¸ªæ–‡ä»¶ä½†æ›´å°ï¼‰

### è°ƒè¯•æ¨¡å¼

å¦‚æœæ‰“åŒ…åæ— æ³•è¿è¡Œï¼Œä½¿ç”¨æ§åˆ¶å°æ¨¡å¼æŸ¥çœ‹é”™è¯¯ï¼š

```bash
pyinstaller --name=SenseVoice --onefile --console webui.py
```

## ğŸ“ åˆ›å»ºç”¨æˆ·å‹å¥½çš„å¯åŠ¨å™¨

å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯åŠ¨å™¨è„šæœ¬ï¼Œè‡ªåŠ¨æ£€æŸ¥æ¨¡å‹å¹¶å¯åŠ¨ï¼š

```python
# launcher.py
import os
import subprocess
import webbrowser

# æ£€æŸ¥æ¨¡å‹
if not os.path.exists("./models/iic/SenseVoiceSmall"):
    print("æ­£åœ¨ä¸‹è½½æ¨¡å‹...")
    subprocess.run(["python", "download_model.py"])

# å¯åŠ¨ Web UI
print("æ­£åœ¨å¯åŠ¨...")
webbrowser.open('http://localhost:7860')
subprocess.run(["python", "webui.py"])
```

ç„¶åæ‰“åŒ…å¯åŠ¨å™¨ï¼š
```bash
pyinstaller --name=SenseVoice --onefile --windowed launcher.py
```

## ğŸ› å¸¸è§é—®é¢˜

### Q: æ‰“åŒ…åæ— æ³•è¿è¡Œï¼Ÿ

A: 
1. ä½¿ç”¨ `--console` æ¨¡å¼æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥æ˜¯å¦æœ‰ç¼ºå¤±çš„éšè—å¯¼å…¥
3. ç¡®ä¿æ‰€æœ‰ä¾èµ–éƒ½å·²å®‰è£…

### Q: æ–‡ä»¶å¤ªå¤§ï¼Ÿ

A:
1. ä½¿ç”¨ `--onedir` æ¨¡å¼ï¼ˆå¤šä¸ªæ–‡ä»¶ï¼‰
2. æ’é™¤ä¸éœ€è¦çš„æ¨¡å—
3. è€ƒè™‘ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒåªå®‰è£…å¿…è¦ä¾èµ–

### Q: å¦‚ä½•æ›´æ–°æ‰“åŒ…çš„ç‰ˆæœ¬ï¼Ÿ

A:
1. æ›´æ–°ä»£ç 
2. é‡æ–°è¿è¡Œæ‰“åŒ…å‘½ä»¤
3. æ›¿æ¢æ—§çš„å¯æ‰§è¡Œæ–‡ä»¶

## ğŸ“š å‚è€ƒèµ„æº

- [PyInstaller å®˜æ–¹æ–‡æ¡£](https://pyinstaller.org/)
- [PyInstaller ä½¿ç”¨æŒ‡å—](https://pyinstaller.readthedocs.io/)

